{% extends "base/base.html" %}
{% load staticfiles %}

{% block title %}
TECS: Test Essay Checking Software | Home
{% endblock %}

{% block custom_style %}
<link rel="stylesheet" href="{% static 'base/css/jquery.countdown.css' %}">	
<script type="text/javascript" src="{% static 'base/js/jquery.countdown.js' %}"></script>

<style>
	.noDays { 		
		width: 240px; 
		height: 45px; 
	}
	#save-text {
		display: none;
	}
</style>

<script>
	$( document ).ready(function() {
    	count()
	});
</script>
{% endblock %}

{% block content %}
<div class="page-content">
	<div class="span10">
		<div class="row-fluid">
			<div class="span12 content">
				<div class="row-fluid">
					<div class="span8">
						<img class="title-icons" src={% static 'base/img/icons/Chat@2x.png' %}>
						<h3 class="title">Answer Exam</h3>
					</div>
					<div class="span4">
						<span class="noDays btn btn-danger pull-right"></span>
					</div>
				</div>
				<form class="form-horizontal" action="" method="post">
					{% csrf_token %}
					<fieldset>
						<dl class="dl-horizontal">
							<dt>Essay Title</dt>
							<dd>{{ essay_response.essay.title }}</dd>

							<dt>Instructions</dt>
							<dd>{{ essay_response.essay.instructions }}</dd>

							<dt>Duration</dt>
							<dd>{{ essay_response.essay.duration_hours }} hr(s) {% if essay_response.essay.duration_minutes > 0%} {{ essay_response.essay.duration_minutes }} min(s) {% endif %}</dd>		

							<dt>Min. no. of words</dt>
							<dd>{{ essay_response.essay.min_words }}</dd>					
						</dl>
						<span id="save-text" class="pull-left text-success"><h2>SAVED!</h2></span>
						<div class="span3 pull-right">
							<input class="wcount span3" type="text" id="word_count" disabled="" value="Word Count: 0"> 
						</div>

						{{ form.response }}

						<div class="form-actions">  
							<button id="draft-button" name="draft" type="submit" class="btn btn-primary"><b>Save As Draft</b> <i class="fui-new"></i></button> 
							<a href="#submit-essay" class="btn btn-success" data-toggle="modal"><b>Submit</b> <i class="fui-check"></i></a> 
						</div>

						<div id="submit-essay" class="modal fade hide" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
								<h3 class="text-warning">Confirm Submission</h3>
							</div>
							<div class="modal-body">
								<p>Are you sure you want to submit?</p>
							</div>
							<div class="modal-footer">		
								<button type="submit" name="final" class="btn btn-success pull-left"><i class="fui-check"></i><b> Yes</b></button>
								<button class="btn btn-inverse" data-dismiss="modal" aria-hidden="true"><i class="fui-cross"></i> Close</button>
							</div>
						</div>

					</fieldset>
				</form>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">
$(function () {
	var liftoffTime = {{ essay_response.time_remaining }};
	$('.noDays').countdown({until: liftoffTime, format: 'HMS'});
});
</script>

<script>
	var output = document.getElementById('word_count');
	var count =0;
</script>

<script>
	function count(){
	  var txtVal = $('#id_response').val();
	  var words = txtVal.trim().replace(/\s+/gi, ' ').split(' ').length;
	  var chars = txtVal.length;
	  if(chars===0){words=0;}
	  output.setAttribute('value', 'Word Count: '+words);
	}

	$('#id_response').on('keyup propertychange', function(){ 
		count();
	});
</script>

<script src="{% static 'base/js/}bootstrap-transition.js' %}"></script>

<script>
	$("#draft-button").click(function() {
		$("#save-text").fadeIn().delay(5000).fadeOut();
	});
</script>

{% endblock %}
